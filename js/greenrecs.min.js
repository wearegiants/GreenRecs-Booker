!function(){function a(a,b){this.el=document.querySelector(a),this.events=b,this.current=moment().date(1),this.el&&this.draw();var c=document.querySelector(".today");if(c){var d=this;window.setTimeout(function(){d.openDay(c)},500)}}function b(a,b){for(var c in b)a.setAttribute(c,b[c])}function c(a,b,c){var d=document.createElement(a);return b&&(d.className=b),c&&(d.innderText=d.textContent=c),d}function d(){var a=document.querySelectorAll('#calendar .event>input[type="radio"]');e();for(var b=0,c=a.length;c>b;b++)a[b].checked=!1,a[b].removeAttribute("checked"),a[b].parentNode.classList.contains("active")&&a[b].parentNode.classList.remove("active")}function e(){[].forEach.call(document.querySelectorAll("div.appointment.msg"),function(a){a&&a.parentNode.removeChild(a)})}var f=moment();a.prototype.draw=function(){this.drawHeader(),this.drawMonth()},a.prototype.drawHeader=function(){var a=this;if(!this.header){this.header=c("div","header"),this.header.className="header",this.title=c("h2","month-title");var b=c("div","right");b.addEventListener("click",function(){a.nextMonth()});var d=c("div","left");d.addEventListener("click",function(){a.prevMonth()}),this.header.appendChild(this.title),this.header.appendChild(b),this.header.appendChild(d),this.el.appendChild(this.header)}this.title.innerHTML=this.current.format("MMMM YYYY")},a.prototype.drawMonth=function(){var a=this;this.month?(this.oldMonth=this.month,this.oldMonth.className="month out "+(a.next?"next":"prev"),this.oldMonth.addEventListener("webkitAnimationEnd",function(){a.oldMonth.parentNode.removeChild(a.oldMonth),a.month=c("div","month"),a.backFill(),a.currentMonth(),a.fowardFill(),a.el.appendChild(a.month),window.setTimeout(function(){a.month.className="month in "+(a.next?"next":"prev")},16)})):(this.month=c("div","month"),this.el.appendChild(this.month),this.backFill(),this.currentMonth(),this.fowardFill(),this.month.className="month new")},a.prototype.backFill=function(){var a=this.current.clone(),b=a.day();if(b){a.subtract(b+1,"days");for(var c=b;c>0;c--)this.drawDay(a.add(1,"days"))}},a.prototype.fowardFill=function(){var a=this.current.clone().add(1,"months").subtract(1,"days"),b=a.day();if(6!==b)for(var c=b;6>c;c++)this.drawDay(a.add(1,"days"))},a.prototype.currentMonth=function(){for(var a=this.current.clone();a.month()===this.current.month();)this.drawDay(a),a.add(1,"days")},a.prototype.getWeek=function(a){this.week&&0!==a.day()||(this.week=c("div","week"),this.month.appendChild(this.week))},a.prototype.drawDay=function(a){var b=this;this.getWeek(a);var d=c("div",this.getDayClass(a));d.addEventListener("click",function(){b.openDay(this)});var e=c("div","day-name",a.format("ddd")),f=c("div","day-number",a.format("DD"));d.appendChild(e),d.appendChild(f),this.week.appendChild(d)},a.prototype.getDayClass=function(a){return classes=["day"],a.month()!==this.current.month()?classes.push("other"):f.isSame(a,"day")&&classes.push("today"),todaysDate=moment(),todaysDate.diff(a,"day")>=1&&classes.push("expired"),classes.join(" ")},a.prototype.openDay=function(a){var b,d,e=+a.querySelectorAll(".day-number")[0].innerText||+a.querySelectorAll(".day-number")[0].textContent,f=this.current.clone().date(e),g=document.querySelector(".details");if(a.classList.contains("expired"))return!1;if(g&&g.parentNode===a.parentNode)b=g,d=document.querySelector(".arrow");else{g&&(g.addEventListener("webkitAnimationEnd",function(){g.parentNode.removeChild(g)}),g.addEventListener("oanimationend",function(){g.parentNode.removeChild(g)}),g.addEventListener("msAnimationEnd",function(){g.parentNode.removeChild(g)}),g.addEventListener("animationend",function(){g.parentNode.removeChild(g)}),g.className="details out"),b=c("div","details in");var d=c("div","arrow");b.appendChild(d),a.parentNode.appendChild(b)}var h=this.events.reduce(function(a,b){return b.date.isSame(f,"day")&&a.push(b),a},[]);this.renderEvents(h,b);var i=a.parentNode.children;i=[].slice.call(i);var j=i.indexOf(a);d.style.left=14.285*(j+1)-7.1425-.5+"%"},a.prototype.renderEvents=function(a,f){var g=f.querySelector(".events"),h=c("div","events in"+(g?" new":"")),k=[],l=6,m=c("div","center-block");for(i=0,j=a.length;i<j;i+=l){eventsChunk=a.slice(i,i+l);var n=c("div"," btn-group-vertical");n.setAttribute("data-toggle","buttons"),eventsChunk.forEach(function(a){var d=c("label","event btn btn-default");b(d,{"iso-date":a.date.format(),id:a.id,"for":"data[apptdate]"});var e=c("input","");b(e,{type:"radio",autocomplete:"off",name:"data[apptdate]",value:a.id,"iso-date":a.date.format(),id:a.id});var f=c("span","",a.eventName),g=c("span","openslot label label-default",a.opencount+" slots left");d.appendChild(e),d.appendChild(f),d.appendChild(g),k.push(d),n.appendChild(d)}),m.appendChild(n),h.appendChild(m)}if(!a.length){var o=c("div","event empty"),p=c("span","noslot"," No Appointments Availible On This Day ");o.appendChild(p),h.appendChild(o)}bindClickButtons=function(){k.forEach(function(a){a.addEventListener("mousedown",function(){this.querySelectorAll("input").checked||(d(),this.classList.add("active"),this.querySelectorAll("input").checked=!0,b(this.querySelectorAll("input")[0],{checked:!0}));var a=this.querySelectorAll("input")[0].getAttribute("iso-date"),e=(this.querySelectorAll("input")[0].getAttribute("slot-id"),c("div","appointment msg col-md-12"," You have selected "+moment(a).format("dddd, MMMM Do YYYY [at] h:mm a")+" as your appointment time. ")),f=c("input","btn btn-default clr-btn pull-right");b(f,{"data-form-id":"calendarform",value:"Request This Time",type:"submit"}),e.appendChild(f),h.parentNode.insertBefore(e,h.parentNode.firstChild),document.getElementById("calendarform").addEventListener("submit",function(a){return a.preventDefault&&a.preventDefault(),a.returnValue=!1,SubmitAction(),!1},!1)})})},SubmitAction=function(){var a=new FormData(document.getElementById("calendarform")),b=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent("pid").replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;a.append("data[pid]",b);var c=new XMLHttpRequest;c.open("POST",document.getElementById("calendarform").getAttribute("action"),!0),c.onloadend=function(){console.log(c)},c.send(a)},g?(g.className="events out",g.addEventListener("webkitAnimationEnd",function(){g.parentNode.removeChild(g),f.appendChild(h),e(),bindClickButtons()}),g.addEventListener("oanimationend",function(){g.parentNode.removeChild(g),f.appendChild(h),e(),bindClickButtons()}),g.addEventListener("msAnimationEnd",function(){g.parentNode.removeChild(g),f.appendChild(h),e(),bindClickButtons()}),g.addEventListener("animationend",function(){g.parentNode.removeChild(g),f.appendChild(h),e(),bindClickButtons()})):(f.appendChild(h),e(),bindClickButtons())},a.prototype.nextMonth=function(){this.current.add(1,"months"),this.next=!0,this.draw()},a.prototype.prevMonth=function(){this.current.subtract(1,"months"),this.next=!1,this.draw()},window.Calendar=a}(),function(){var a=new XMLHttpRequest;a.open("GET","https://yerbaverde.local/freeschedule",!0),a.onloadend=function(){if(a.status>=200&&a.status<400){var b=JSON.parse(a.responseText),c=0;b.forEach(function(a){a.id=parseInt(a.id),a.opencount=parseInt(a.slots_available),a.date=c>3?moment(a.availability_slot):moment(),a.eventName=a.date.format("h:mm A"),c++,delete a.slots_available,delete a.availability_slot}),console.log(b);{new Calendar("#calendar",b)}}else console.log(a.response)},a.send()}();
//# sourceMappingURL=greenrecs.min.js.map